<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Mirage Quick Start Guide </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Mirage Quick Start Guide ">
    <meta name="generator" content="docfx 2.56.6.0">
    
    <link rel="shortcut icon" href="../../../../favicon.ico">
    <link rel="stylesheet" href="../../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../../../toc.html">
    <meta property="docfx:tocrel" content="../../../toc.html">
    
    <meta property="docfx:rel" content="../../../../">
    
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../../index.html">
                <img id="logo" class="svg" src="../../../../logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="mirage-quick-start-guide">Mirage Quick Start Guide</h1>

<p>This guide currently shows you:</p>
<ul>
<li><a href="#part-1">Basic scene setup</a></li>
<li><a href="#part-4">Player movement</a></li>
<li><a href="#part-8">Names and colours</a></li>
<li><a href="#part-11">Scene script with canvas buttons</a></li>
<li><a href="#part-12">Weapon switching</a></li>
</ul>
<p>It is best to first make a mini practice game before converting your single player game, or creating your ideal brand new multiplayer.</p>
<p>The Pre-made Mirage examples are great for using as reference, it is recommend to use them regarding connection setup, with ports and firewalls. This can be a huge topic that changes from person to person, and is not covered in this guide, here we will use localHost (multiple games on same PC).</p>
<h2 id="part-1">Part 1</h2>
<p>Blank Project, import UniTask and Mirage using Unity package manager.</p>
<h2 id="part-2">Part 2</h2>
<ul>
<li>Create new scene, save it, and add it to build settings</li>
<li>Create a new GameObject, name it NetworkManager in the scene, and add these 3 components
<ul>
<li>NetworkManager</li>
<li>KcpTransport</li>
<li>NetworkManagerHUD</li>
</ul>
</li>
<li>On the NetworkManager component, drag your Offline and Online scene into the slots, we have only one scene
for now, so put your scene in both
<ul>
<li>The scene must be in the build settings before dragging it to the field</li>
</ul>
</li>
</ul>
<p><img src="image--000.jpg" alt=""></p>
<p><img src="image--001.jpg" alt=""></p>
<h2 id="part-3">Part 3</h2>
<p>Setup the scene</p>
<ul>
<li>Add a simple Plane floor with:
<ul>
<li>positions (0, -1, 0)</li>
<li>scale (2, 2, 2)</li>
</ul>
</li>
<li>(optional) add a material to this, I added one called dirt that is used one of mirrors examples</li>
<li>Next we add a GameObject, name does not matter</li>
<li>Add <code>NetworkStartPosition</code> component to this GameObject</li>
<li>Duplicate the GameObject a few times, and scatter around your scene floor so that you have multiple spawn points. I did 4, one near each corner</li>
</ul>
<p><img src="image--002.jpg" alt=""></p>
<h2 id="part-4">Part 4</h2>
<p>Creating the player</p>
<ul>
<li>Create a capsule using the menus as shown in the image</li>
<li>Attached a NetworkTransform component, this will auto add a Network Identity</li>
<li>Tick Client Authority on the NetworkTransform</li>
</ul>
<p><img src="image--003.jpg" alt=""></p>
<ul>
<li>Rename that object Player</li>
<li>Add an empty PlayerScript</li>
<li>Drag into Project to create a prefab</li>
<li>Then delete Player from scene</li>
</ul>
<p><img src="image--004.jpg" alt=""></p>
<ul>
<li>Drag your player prefab into Network manager,</li>
<li>Set spawn method to Round Robin.</li>
</ul>
<p><img src="image--005.jpg" alt=""></p>
<h2 id="part-5">Part 5</h2>
<p>Add the following to your PlayerScript.</p>
<pre><code class="lang-cs">using Mirage;
using UnityEngine;

namespace QuickStart
{
    public class PlayerScript : NetworkBehaviour
    {
        public override void OnStartLocalPlayer()
        {
            Camera.main.transform.SetParent(transform);
            Camera.main.transform.localPosition = new Vector3(0, 0, 0);
        }

        void Update()
        {
            if (!isLocalPlayer) { return; }

            float moveX = Input.GetAxis(&quot;Horizontal&quot;) * Time.deltaTime * 110.0f;
            float moveZ = Input.GetAxis(&quot;Vertical&quot;) * Time.deltaTime * 4f;

            transform.Rotate(0, moveX, 0);
            transform.Translate(0, 0, moveZ);
        }
    }
}
</code></pre>
<h2 id="part-6">Part 6</h2>
<p>Press play in Unity editor, and then Host (server + client) button in the game window. You should be able to move around with a first person view capsule.</p>
<p><img src="image--006.jpg" alt=""></p>
<h2 id="part-7">Part 7</h2>
<p>Build and run your scene, open it, host on one, and press the Client button on the other. Congrats you made a mini multiplayer game!</p>
<p><img src="image--007.jpg" alt=""></p>
<h2 id="part-8">Part 8</h2>
<p>Player name above heads</p>
<ul>
<li>Inside your player Prefab, create an empty GameObject</li>
<li>name it something like <code>FloatingInfo</code>
<ul>
<li>position Y to 1.5</li>
<li>scale X to -1</li>
</ul>
</li>
<li>Inside that <code>FloatingInfo</code>, create a 3D text using Unity menu (GameObject - 3D Object - 3D Text),</li>
<li>Set it up as shown in the picture below</li>
</ul>
<p><img src="image--008.jpg" alt=""></p>
<h2 id="part-9">Part 9</h2>
<p>Update your PlayerScript.cs with this:</p>
<pre><code class="lang-cs">using Mirage;
using UnityEngine;

namespace QuickStart
{
    public class PlayerScript : NetworkBehaviour
    {
        public TextMesh playerNameText;
        public GameObject floatingInfo;

        private Material playerMaterialClone;

        [SyncVar(hook = nameof(OnNameChanged))]
        public string playerName;

        [SyncVar(hook = nameof(OnColorChanged))]
        public Color playerColor = Color.white;

        void OnNameChanged(string _Old, string _New)
        {
            playerNameText.text = playerName;
        }

        void OnColorChanged(Color _Old, Color _New)
        {
            playerNameText.color = _New;
            playerMaterialClone = new Material(GetComponent&lt;Renderer&gt;().material);
            playerMaterialClone.color = _New;
            GetComponent&lt;Renderer&gt;().material = playerMaterialClone;
        }

        public override void OnStartLocalPlayer()
        {
            Camera.main.transform.SetParent(transform);
            Camera.main.transform.localPosition = new Vector3(0, 0, 0);
            
            floatingInfo.transform.localPosition = new Vector3(0, -0.3f, 0.6f);
            floatingInfo.transform.localScale = new Vector3(0.1f, 0.1f, 0.1f);

            string name = &quot;Player&quot; + Random.Range(100, 999);
            Color color = new Color(Random.Range(0f, 1f), Random.Range(0f, 1f), Random.Range(0f, 1f))
            CmdSetupPlayer(name, color);
        }

        [Command]
        public void CmdSetupPlayer(string _name, Color _col)
        {
            // player info sent to server, then server updates sync vars which handles it on all clients
            playerName = _name;
            playerColor = _col;
        }

        void Update()
        {
            if (!isLocalPlayer)
            {
                // make non-local players run this
                floatingInfo.transform.LookAt(Camera.main.transform);
                return;
            }

            float moveX = Input.GetAxis(&quot;Horizontal&quot;) * Time.deltaTime * 110.0f;
            float moveZ = Input.GetAxis(&quot;Vertical&quot;) * Time.deltaTime * 4f;

            transform.Rotate(0, moveX, 0);
            transform.Translate(0, 0, moveZ);
        }
    }
}
</code></pre>
<h2 id="part-10">Part 10</h2>
<p>Add the <code>PlayerNameText</code> and <code>FloatingInfo</code> objects into the script on the player prefab, as shown below.</p>
<p><img src="image--009.jpg" alt=""></p>
<p>Now if you build and run, host on one, join on the other, you will see player names and colors synced across the network!</p>
<p>Well done, 5 stars to you!</p>
<p><img src="image--010.jpg" alt=""></p>
<h2 id="part-11">Part 11</h2>
<p>A scene networked object all can access and adjust.</p>
<p>Create a SceneScript.cs, add it onto an empty GameObject in the scene called SceneScript.</p>
<p>Then create a Canvas with text and button, similar to below.</p>
<p><img src="image--011.jpg" alt=""></p>
<p>Add the sceneScript variable, Awake function, and CmdSendPlayerMessage to PlayerScript.cs
Also add the new playerName joined line to CmdSetupPlayer();</p>
<pre><code class="lang-cs">private SceneScript sceneScript;

void Awake()
{
    //allow all players to run this
    sceneScript = GameObject.FindObjectOfType&lt;SceneScript&gt;();
}
[Command]
public void CmdSendPlayerMessage()
{
    if (sceneScript) 
    { 
        sceneScript.statusText = $&quot;{playerName} says hello {Random.Range(10, 99)}&quot;;
    }
}
[Command]
public void CmdSetupPlayer(string _name, Color _col)
{
    //player info sent to server, then server updates sync vars which handles it on all clients
    playerName = _name;
    playerColor = _col;
    sceneScript.statusText = $&quot;{playerName} joined.&quot;;
}
public override void OnStartLocalPlayer()
{
    sceneScript.playerScript = this;
    //. . . . ^ new line to add here
</code></pre>
<p>Add this code to SceneScript.cs</p>
<pre><code class="lang-cs">using Mirage;
using UnityEngine;
using UnityEngine.UI;

namespace QuickStart
{
    public class SceneScript : NetworkBehaviour
    {
        public Text canvasStatusText;
        public PlayerScript playerScript;

        [SyncVar(hook = nameof(OnStatusTextChanged))]
        public string statusText;

        void OnStatusTextChanged(string _Old, string _New)
        {
            //called from sync var hook, to update info on screen for all players
            canvasStatusText.text = statusText;
        }

        public void ButtonSendMessage()
        {
            if (playerScript != null)  
            {
                playerScript.CmdSendPlayerMessage();
            }
        }
    }
}
</code></pre>
<ul>
<li>Attach the ButtonSendMessage function to your Canvas Button.</li>
<li>Attach Canvas Scene Text to SceneScript variable.
<ul>
<li>ignore SceneScript’s, playerScript variable, it automatically sets this!</li>
</ul>
</li>
</ul>
<p><img src="image--012.jpg" alt="">
<img src="image--013.jpg" alt=""></p>
<p>Now if you build and run, host and join, you can send messages, and have a text log for actions!</p>
<p>Wahooo!</p>
<p><img src="image--014.jpg" alt="">
<img src="image--015.jpg" alt=""></p>
<p>Experiment and adjust, have fun!</p>
<p><img src="image--016.jpg" alt=""></p>
<h2 id="part-12">Part 12</h2>
<p>Weapon switching! The code bits.</p>
<p>Add the following to your PlayerScript.cs</p>
<pre><code class="lang-cs">private int selectedWeaponLocal = 1;
public GameObject[] weaponArray;

[SyncVar(hook = nameof(OnWeaponChanged))]
public int activeWeaponSynced;

void OnWeaponChanged(int _Old, int _New)
{
    // disable old weapon
    // in range and not null
    if (0 &lt; _Old &amp;&amp; _Old &lt; weaponArray.Length &amp;&amp; weaponArray[_Old] != null)
    {
        weaponArray[_Old].SetActive(false);
    }
    
    // enable new weapon
    // in range and not null
    if (0 &lt; _New &amp;&amp; _New &lt; weaponArray.Length &amp;&amp; weaponArray[_New] != null)
    {
        weaponArray[_New].SetActive(true);
    }
}

[Command]
public void CmdChangeActiveWeapon(int newIndex)
{
    activeWeaponSynced = newIndex;
}

void Awake() 
{
    // disable all weapons
    foreach (var item in weaponArray)
    {
        if (item != null)
        { 
            item.SetActive(false); 
        }
    }
}
</code></pre>
<p>Add the weapon switch button in update. Only local player switches its own weapon, so it goes below the <code>!isLocalPlayer</code> check.</p>
<pre><code class="lang-cs">void Update()
{
    if (!isLocalPlayer)
    {
        // make non-local players run this
        floatingInfo.transform.LookAt(Camera.main.transform);
        return;
    }

    float moveX = Input.GetAxis(&quot;Horizontal&quot;) * Time.deltaTime * 110.0f;
    float moveZ = Input.GetAxis(&quot;Vertical&quot;) * Time.deltaTime * 4f;

    transform.Rotate(0, moveX, 0);
    transform.Translate(0, 0, moveZ);

    if (Input.GetButtonDown(&quot;Fire2&quot;)) //Fire2 is mouse 2nd click and left alt
    {
        selectedWeaponLocal += 1;

        if (selectedWeaponLocal &gt; weaponArray.Length) 
        {
            selectedWeaponLocal = 1; 
        }

        CmdChangeActiveWeapon(selectedWeaponLocal);
    }
}
</code></pre>
<h2 id="part-13">Part 13</h2>
<p>Weapon models</p>
<p>Add the basic cube weapons first, change these later.</p>
<ul>
<li>Double click your player prefab to enter it</li>
<li>Add a &quot;WeaponsHolder&quot; empty GameObject, with position and rotation at 0,0,0.</li>
<li>Inside that GameObject, create a cube from unity menu, (GameObject, 3D object, cube)- Remove the box colliders.</li>
<li>Rename this <code>Weapon1</code>, change position and scale to match the below pictures.</li>
</ul>
<p><img src="image--017.jpg" alt=""></p>
<p>Duplicate weapon 1 for a Weapon 2, and change its scale and position, now you should have 2 different looking ‘weapons’!</p>
<p><img src="image--018.jpg" alt=""></p>
<h2 id="part-14">Part 14</h2>
<p>Weapon switch finale.</p>
<ul>
<li>Add these 2 GameObjects to your PlayerScript.cs weapons array.</li>
<li>Disable weapon 2, so only weapon 1 shows when spawning.</li>
</ul>
<p><img src="image--019.jpg" alt=""></p>
<p>Build and run!</p>
<p>You should see each player switching weapons, and whatever your player has equipped, will auto show on new joining players (sync var and hook magic!)</p>
<p><img src="image--020.jpg" alt=""></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../../styles/main.js"></script>
  </body>
</html>
